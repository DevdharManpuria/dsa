#include <bits/stdc++.h>using namespace std;using ll=long long;int main(){	int t;	cin>>t;	while(t--){		int n; cin>>n;		vector<int>a(n);		for(auto &i:a) cin>>i;		vector<pair<int,int>>v;		for(int i=0;i<n;i++){			v.push_back({a[i],i});		}		sort(v.rbegin(),v.rend());		vector<int>ans(n+1,0);		ans[0]=0;		int x=1;		ll min=0;		for(int i=0;i<n;i++){			ans[v[i].second+1]=x;			min+=(1LL*2*abs(x)*v[i].first);			if(x<0) x=abs(x)+1;			else x=-x;		}		cout<<min<<endl;		for(auto &i:ans) cout<<i<<" ";		cout<<endl;	}}